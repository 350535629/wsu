\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Cpts575 Hw5},
            pdfauthor={Mengxiao Zhang},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Cpts575 Hw5}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Mengxiao Zhang}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
    \date{}
    \predate{}\postdate{}
  

\begin{document}
\maketitle

\hypertarget{part-1}{%
\section{Part 1}\label{part-1}}

\hypertarget{a.-estimate-the-probability.}{%
\subsection{a. Estimate the
probability.}\label{a.-estimate-the-probability.}}

The predict function is :
\[\hat{p}=\frac{e^{-7+0.1X_1+X_2-0.04X_3}}{1+e^{-7+0.1X_1+X_2-0.04X_3}}\]
\[\hat{p}(X_1=32,X_2=3.0,X_3=12)=0.2175502\] So, the probability of gets
an A in the class is 21.75502\%

\hypertarget{b.-how-many-hours-would-the-student-need-to-study.}{%
\subsection{b. How many hours would the student need to
study.}\label{b.-how-many-hours-would-the-student-need-to-study.}}

According to the question a, we have the predict function and we need to
let the predict equal to at least 0.5.
\[\hat{p}(X_1=a, x_2=3.0, x_3=12)=0.5\]
\[\Rightarrow\frac{e^{-7+0.1a+3.0-0.04*12}}{1+e^{-7+0.1a_1+3.0-0.04*12}} = 0.5\]
\[\Rightarrow e^{-7+0.1a+3.0-0.04*12} = 1\]
\[\Rightarrow -7+0.1a+3.0-0.04*12 = 0\] \[\Rightarrow a = 44.8\] So, the
student is part(a) needs to study 44.8 hours to have 50\% chance of
getting an A.

\hypertarget{c.-how-many-hours-would-a-student-with-3.0-gpa-and-a-psqi-score-of-3-need-to-have-a-50-chance-of-getting-an-a.}{%
\subsection{c. How many hours would a student with 3.0 GPA and a PSQI
score of 3 need to have a 50\% chance of getting an
A.}\label{c.-how-many-hours-would-a-student-with-3.0-gpa-and-a-psqi-score-of-3-need-to-have-a-50-chance-of-getting-an-a.}}

\[\hat{p}(X_1=a, x_2=3.0, x_3=3)=0.5\]

\[\Rightarrow\frac{e^{-7+0.1a+3.0-0.04*3}}{1+e^{-7+0.1a_1+3.0-0.04*3}} = 0.5\]
\[\Rightarrow -7+0.1a+3.0-0.04*3 = 0\] \[\Rightarrow a = 41.2\] So, the
students with 3.0 GPA and PSQI score of 3 need to study 41.2 hours to
have 50\% chance of getting an A.

\hypertarget{part-2}{%
\section{Part 2}\label{part-2}}

\hypertarget{a.-data-collection.}{%
\subsection{a. Data Collection.}\label{a.-data-collection.}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(RJSONIO)}
\NormalTok{sections =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"world"}\NormalTok{, }\StringTok{"science"}\NormalTok{, }\StringTok{"business"}\NormalTok{, }\StringTok{"technology"}\NormalTok{, }\StringTok{"sport"}\NormalTok{, }\StringTok{"environment"}\NormalTok{)}
\NormalTok{mydata =}\StringTok{ }\KeywordTok{setNames}\NormalTok{(}\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{ncol =} \DecValTok{4}\NormalTok{, }\DataTypeTok{nrow =} \DecValTok{0}\NormalTok{)),}
                  \KeywordTok{c}\NormalTok{(}\StringTok{"id"}\NormalTok{, }\StringTok{"title"}\NormalTok{, }\StringTok{"body"}\NormalTok{, }\StringTok{"section"}\NormalTok{))}
\NormalTok{n =}\StringTok{ }\DecValTok{0}
\NormalTok{dataset =}\StringTok{ }\KeywordTok{list}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (page }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{)\{}
    \ControlFlowTok{for}\NormalTok{ (s }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(sections))\{}
\NormalTok{        url =}\StringTok{ }\KeywordTok{paste}\NormalTok{(}\StringTok{"http://content.guardianapis.com/search?section="}\NormalTok{, sections[s], }\StringTok{"&lang=en&show-fields=body&page="}\NormalTok{, page, }\StringTok{"&page-size=120&api-key=14453543-e613-4acb-a757-e79000c47ca9"}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{)}
\NormalTok{        data =}\StringTok{ }\KeywordTok{fromJSON}\NormalTok{(url)}\OperatorTok{$}\NormalTok{response}\OperatorTok{$}\NormalTok{results}
        \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{120}\NormalTok{)\{}
            \ControlFlowTok{if}\NormalTok{ (data[[i]]}\OperatorTok{$}\NormalTok{type }\OperatorTok{==}\StringTok{ "article"}\NormalTok{)\{}
\NormalTok{                mydata[}\KeywordTok{nrow}\NormalTok{(mydata)}\OperatorTok{+}\DecValTok{1}\NormalTok{,] =}\StringTok{ }\KeywordTok{c}\NormalTok{(data[[i]]}\OperatorTok{$}\NormalTok{id, data[[i]]}\OperatorTok{$}\NormalTok{webTitle, data[[i]]}\OperatorTok{$}\NormalTok{fields, data[[i]]}\OperatorTok{$}\NormalTok{sectionId)}
\NormalTok{            \}}
\NormalTok{        \}}
\NormalTok{    \}}
\NormalTok{\}}
\NormalTok{mydata[}\DecValTok{1}\NormalTok{,]}\OperatorTok{$}\NormalTok{body}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "<p>In a dramatic comeback, Cristina Fernández de Kirchner, one of Argentina’s most popular presidents during her two terms in 2007-2015, has been voted back into office as vice president.</p> <p>A large crowd of supporters burst into a roar outside the Frente de Todos (Everybody’s Front) party bunker in the Chacarita neighbourhood of the capital city of Buenos Aires at 9pm when preliminary official results gave the victory to the centre left presidential candidate Alberto Fernández and his running mate Fernández de Kirchner.</p> <p>Incumbent Mauricio Macri conceded defeat on Sunday night, telling supporters at his headquarters that he had called Fernández to congratulate him and invited him for a breakfast chat on Monday at the Pink Presidential Palace.</p> <p>“We need an orderly transition that will bring tranquility to all Argentinians, because the most important thing is the wellbeing of all Argentinians,” Macri said.</p> <p>With more than 90% of ballots counted, Fernández, who is no relation of Fernández de Kirchner, had 47.79% of the vote, compared to Macri’s 40.71%.</p> <aside class=\"element element-rich-link element--thumbnail\"> <p> <span>Related: </span><a href=\"https://www.theguardian.com/world/2019/oct/24/christina-de-fernandez-kirchner-argentina-marci\">Cristina's comeback: Fernández de Kirchner set for dramatic return as Argentina's No 2</a> </p> </aside>  <p>The victory puts an end to the pro-business economic policies of Macri’s administration, who promised “zero poverty” during his electoral campaign but exits office with a plunging peso, an inflation rate that rocketed to an annual 56% and the number of people living beneath the breadline having risen from 29% to 35%.</p> <p>President-elect Fernández, who assumes office on 10 December, is a moderate Peronist who has pledged to respect the $57bn IMF loan taken out by Macri last year to try and salvage Argentina’s creaking economy while promising to improve wages and benefits for workers and pensioners.</p> <p>His victory was widely expected and car horns started sounding non-stop in Buenos Aires after polling booths closed at 6pm on Sunday celebrating his victory.</p> <p>In one quiet neighbourhood, a group of bicycle delivery workers– one of the few job opportunities available for young people during Macri’s administration – rode through the streets tinkling their bells ecstatically celebrating the end of hisgovernment.</p> <p> Argentina’s elections, traditionally held the last Sunday of October, coincided this year with the ninth anniversary of the death from a sudden heart attack of Néstor Kirchner, the husband and predecessor in office of Fernández de Kirchner. During his 2003-2007 administration Kirchner led Argentina’s recovery from its economic collapse and monumental foreign debt default in 2001-2002.</p> <p>Cristina Fernández served as president from 2007 to 2015. By the time she left office she was entangled in a string of court cases involving accusations of <a href=\"https://www.theguardian.com/world/2018/sep/17/cristina-fernandez-indicted-argentina-president-corruption\">bribery</a>, <a href=\"https://www.theguardian.com/world/2016/apr/09/argentina-cristina-fernandez-de-kirchner-money-laundering-investigation\">money laundering</a>, <a href=\"https://www.theguardian.com/world/2016/dec/27/cristina-fernandez-de-kirchner-indicted-corruption-argentina\">corruption</a> and allegations that she had <a href=\"https://www.theguardian.com/world/2017/oct/26/argentina-jewish-center-bombing-cristina-fernandez-de-kirchner\">helped cover up Iran’s involvement </a>in a terrorist bombing that prosecutor was investigating. Some of the corruption cases are ongoing. She denies any wrongdoing.</p> <aside class=\"element element-rich-link element--thumbnail\"> <p> <span>Related: </span><a href=\"https://www.theguardian.com/world/2019/aug/18/cristina-kirchner-fiery-ex-president-returns-crisis-argentina\">Plunging peso, grinding poverty: Argentina hears echoes of 2001 crisis</a> </p> </aside>  <p>The memory of the period of sustained economic growth in the 2000s, during which time Fernández was cabinet chief, played an important part in the election campaign.</p> <p>Reflecting his confidence in an easy win, Fernández, an amateur musician who enjoys hanging out with rock stars, spent a relaxed Saturday afternoon playing guitar and singing 1960s and 70s Argentine rock songs with Gustavo Santaolalla, the Argentine musician who won two consecutive Academy Awards for Brokeback Mountain and Babel in 2005-2006. A short video of the impromptu jam uploaded by Fernández’s spokesman Juan Pablo Biondi soon reached over 170 thousand views on Twitter.</p>  <figure class=\"element element-tweet\" data-canonical-url=\"https://twitter.com/JuanPabloBiondi/status/1188197573317812224\">  <blockquote class=\"twitter-tweet\"><p lang=\"es\" dir=\"ltr\">Lujos de esta campaña que termina con broche de oro! Yo ya gané ✌️ <a href=\"https://t.co/IfPWAAfJMS\">pic.twitter.com/IfPWAAfJMS</a></p>&mdash; Juan Pablo Biondi (@JuanPabloBiondi) <a href=\"https://twitter.com/JuanPabloBiondi/status/1188197573317812224?ref_src=twsrc%5Etfw\">October 26, 2019</a></blockquote>  </figure>  <p>On Saturday Fernández de Kirchner visited her husband’s mausoleum in the Patagonian city of Río Gallegos and Sunday midday she was greeted by a large adoring crowd at the polling booth. “This is such an important day for democracy,” Fernández de Kirchner said to journalists after voting.</p>"
\end{verbatim}

\hypertarget{b.-data-cleaning.}{%
\subsection{b. Data cleaning.}\label{b.-data-cleaning.}}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(mydata))\{}
    \KeywordTok{Encoding}\NormalTok{(mydata[i,][[}\StringTok{"body"}\NormalTok{]]) <-}\StringTok{ "UTF-8"}
    \KeywordTok{Encoding}\NormalTok{(mydata[i,][[}\StringTok{"title"}\NormalTok{]]) <-}\StringTok{ "UTF-8?gsub"}
\NormalTok{    mydata[i,]}\OperatorTok{$}\NormalTok{body <-}\StringTok{ }\KeywordTok{gsub}\NormalTok{(}\StringTok{"<.*?>"}\NormalTok{, }\StringTok{""}\NormalTok{, mydata[i,][[}\StringTok{"body"}\NormalTok{]])}
\NormalTok{    mydata[i,]}\OperatorTok{$}\NormalTok{body <-}\StringTok{ }\KeywordTok{gsub}\NormalTok{(}\StringTok{"[^[:alnum:][:space:]]"}\NormalTok{,}
\StringTok{""}\NormalTok{, mydata[i,][[}\StringTok{"body"}\NormalTok{]])}
\NormalTok{    mydata[i,]}\OperatorTok{$}\NormalTok{body <-}\StringTok{ }\KeywordTok{tolower}\NormalTok{(mydata[i,][[}\StringTok{"body"}\NormalTok{]])}
\NormalTok{\}}
\KeywordTok{strwrap}\NormalTok{(mydata[}\DecValTok{432}\NormalTok{,]}\OperatorTok{$}\NormalTok{body, }\DataTypeTok{width=}\DecValTok{80}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "a sleek machine that looks like a mashup between a grandprix car a fighter"     
##  [2] "plane and a spaceship has undergone a final earsplitting test in the uk before" 
##  [3] "being shipped to a desert in south africa where it may eventually reach a speed"
##  [4] "of 1000mph over the past six months the bloodhound lsr has taken shape in a"    
##  [5] "workshop on a college campus in gloucestershire and on monday a dry crank test" 
##  [6] "was carried out in which the car was powered up to confirm that the engine and" 
##  [7] "systems had been correctly installed the roar of the engine could be heard"     
##  [8] "throughout sgs berkeley green university technical college and those who were"  
##  [9] "nearby had to wear earplugs so as not to be overpowered by the din bloodhound"  
## [10] "will now be carefully transported from its home on the banks of the river"      
## [11] "severn to the hakskeenpan in the kalahari desert where about 150 local people"  
## [12] "are clearing stones from a 12mile test track in the next couple of months the"  
## [13] "ambition is to drive the jetpowered car at more than 500mph as fast as a"       
## [14] "commercial aircrafts cruising speed the team will analyse the data gathered"    
## [15] "during a series of runs and in 12 to 18 months will try to break the current"   
## [16] "landspeed record of 763035mph and then take the car past the 1000mph mark at"   
## [17] "full design speed bloodhound could cover a mile in 36 seconds its solid"        
## [18] "aluminium wheels would spin at up to 10200 rpm revolutions per minute more than"
## [19] "four times faster than wheels on a formula one car at top speed last year"      
## [20] "bloodhound which has been more than a decade in the making looked to have hit a"
## [21] "financial roadblock when the company previously behind the venture went into"   
## [22] "administration it was saved at the last minute by a yorkshire businessman ian"  
## [23] "warhurst and moved to its current base warhurst admitted there had been times"  
## [24] "when he felt like tearing his hair out in frustration but it had all come"      
## [25] "together something which has been talked about and planned for so long is now"  
## [26] "really happening he said bloodhound is powered with a jet engine produced by"   
## [27] "rollsroyce and normally found on the eurofighter typhoon fighter jet and a"     
## [28] "rocket system to give it a bit of extra poke the bloodhound team say a key aim" 
## [29] "of the project is to inspire young people such as the students at berkeley"     
## [30] "green to become engineers while trying to make the project as environmentally"  
## [31] "friendly as they can for the moment they concede they are using conventional"   
## [32] "jet fuel one engineer described it as a firebreathing monster but are keen to"  
## [33] "find out for example if bloodhound could run on biofuel engineering director"   
## [34] "mark chapman said one of the main aims of this autumns trip was to test ways"   
## [35] "not only of making the car travel at great speed but making sure it could be"   
## [36] "stopped safely the hardest thing is stopping before you run out of desert two"  
## [37] "parachutes will be deployed to stop the car if it doesnt halt it will hit sand" 
## [38] "dunes and then namibia chapman said he couldnt wait to see the car put through" 
## [39] "its paces in the desert after many years in preparation we cant wait to get out"
## [40] "to the hakskeenpan and let bloodhound off the leash to see just how it performs"
\end{verbatim}

\hypertarget{c.-tokenization.}{%
\subsection{c. Tokenization.}\label{c.-tokenization.}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(tm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: NLP
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{TermMatrix =}\StringTok{ }\KeywordTok{DocumentTermMatrix}\NormalTok{(}\KeywordTok{Corpus}\NormalTok{(}\KeywordTok{VectorSource}\NormalTok{(mydata}\OperatorTok{$}\NormalTok{body)),}
                                \DataTypeTok{control=}\KeywordTok{list}\NormalTok{(}\DataTypeTok{removeNumbers=}\OtherTok{TRUE}\NormalTok{,}
                                                \DataTypeTok{stopwords=}\OtherTok{TRUE}\NormalTok{,}
                                                \DataTypeTok{stemming=}\OtherTok{TRUE}\NormalTok{))}
\KeywordTok{as.matrix}\NormalTok{(TermMatrix[}\DecValTok{32}\NormalTok{, }\KeywordTok{which}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(TermMatrix[}\DecValTok{32}\NormalTok{, ]) }\OperatorTok{!=}\StringTok{ }\DecValTok{0}\NormalTok{)])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     Terms
## Docs abl abroad absolut access accord account accru acknowledg across
##   32   1      1       1      4      1       1     1          1      3
##     Terms
## Docs actual adapt addit adhes adjust affili afloat age ago air alami allow
##   32      1     1     1     1      1      1      1   1   3   1     1     1
##     Terms
## Docs almost alreadi also alway america amount amplifi analyst anecdot
##   32      1       2    6     1       1      1       1       1       1
##     Terms
## Docs anoth antagon antidot antimonopoli appli april aquarium architect
##   32     1       1       1            1     1     1        1         1
##     Terms
## Docs area around articl aspir assembl asset atmospher attack attempt
##   32    3      1      1     1       4     1         1      2       1
##     Terms
## Docs attitud audi austria author automobil autumn averag avoid away back
##   32       1    6       1      2         2      1      4     1    2    4
##     Terms
## Docs backwat bad balcerowicz baloghgetti baltic banach basket becom begin
##   32       1   2           2           1      2      2      1     3     1
##     Terms
## Docs behind believ benefit berlin best better big biggest birth birthday
##   32      2      2       1      2    2      6   2       2     1        1
##     Terms
## Docs blame bloc bodi book border born brexit bring bucharest budapest
##   32     1    5    1    1      1    2      1     3         1        1
##     Terms
## Docs build built bulgaria bulgarian busi call came can cant cantanker
##   32     1     1        1         1    6    1    2   4    2         1
##     Terms
## Docs capit capitalist car carload carsten case catch central centrepiec
##   32     8          1   4       1       1    1     2       8          1
##     Terms
## Docs centuri chain champion chang charg chart cheapli check children china
##   32       1     2        1     3     1     4       1     3        1     1
##     Terms
## Docs chronic chungth circumst citi class client clinic close coast
##   32       1       1        1    3     1      1      1     1     1
##     Terms
## Docs coeffici collaps collar colourcod combin come comfort communism
##   32        1       3      1         1      1    3       1         7
##     Terms
## Docs communist communistera compani compar compart competit complain
##   32         6            1       4      4       1        2        1
##     Terms
## Docs complet complex concret condescend condit confront congress construct
##   32       1       1       2          1      2        1        1         2
##     Terms
## Docs contact contin continu contribut control converg convinc couldnt
##   32       1      1       2         1       1       1       1       1
##     Terms
## Docs council counterproduct countri coup court cover critic cross crucial
##   32       1              1      15    1     1     1      2     1       1
##     Terms
## Docs current curtain cut czarek czech dan dark day deal decad decay declin
##   32       3       2   1      1     1   1    2   2    1     5     2      1
##     Terms
## Docs deem deliv demand demonstr denot depend devast develop die director
##   32    1     1      1        1     1      2      1       5   1        1
##     Terms
## Docs disast disgruntl distribut diversifi divid divis doctor dont door
##   32      1         1         2         1     1     1      1    1    1
##     Terms
## Docs doormat dozen dramat drawn dri eager earli easi east eastern econom
##   32       1     1      1     1   1     1     1    1    6       6      8
##     Terms
## Docs economi economist educ effect els elsewher email emigr employe end
##   32       6         1    1      1   1        2     2     2       1   2
##     Terms
## Docs engin enterpris enthusiast entir entrepreneur environment equal estim
##   32     2         1          1     1            2           1     1     1
##     Terms
## Docs estonia europ european even eventu ever everi everyon exampl expect
##   32       1    13        9    3      1    4     2       2      1      2
##     Terms
## Docs experi experienc extent extraordinari fact factor factori fair fall
##   32      1         2      2             1    1      1       5    1    1
##     Terms
## Docs famous far fast fear feasibl feel fifteen fifth figur fill financ
##   32      1   1    3    1       1    5       1     1     1    1      1
##     Terms
## Docs fire first fish fit fivefold flight floor focus forc foreign form
##   32    1     4    2   1        1      3     1     1    1       1    1
##     Terms
## Docs former forward framework freedom friday fulli gap gather gdańsk
##   32      4       2         2       1      1     2   2      1       9
##     Terms
## Docs general generat german germani get giant gini given gloomi golden
##   32       1       3      5       2   2     1    2     1      1      1
##     Terms
## Docs gone good govern grabski grant grim group grown growth guardian győr
##   32    1    1      5       5     1    1     1     1      6        1    5
##     Terms
## Docs half hall hamburg hammer hand hangar happen havent head headi health
##   32    2    3       1      1    1      1      2      1    2     1      1
##     Terms
## Docs healthi healthier hear heavi held help herald hero hide higher home
##   32       1         1    1     1    1    1      1    1    1      1    1
##     Terms
## Docs hope hopeless howev hub huge hulk human hundr hungari hungaria
##   32    1        1     3   1    2    1     2     1       5        1
##     Terms
## Docs hungarian idea imag immigr impress improv inbox incipi incom incompar
##   32         1    3    2      1       1      2     1      1     1        1
##     Terms
## Docs inde independ individu industri inequ inevit infrastructur innov
##   32    1        1        1        2     1      1             2     2
##     Terms
## Docs input insid institut integr interest intern internet interview
##   32     1     1        3      2        1      1        1         2
##     Terms
## Docs introduct invest involv iron issu japanes join jolanta journalist
##   32         1      2      1    2    1       1    3       1          1
##     Terms
## Docs just karoli karolina keep kept key kind koallgetti kraków larg last
##   32    2      1        1    2    1   2    1          1       1    1    3
##     Terms
## Docs lászló later latvia latvian law lead leader lech led left leftist
##   32        2     1      3       1   2    1      1    2   4    2       1
##     Terms
## Docs leszek level life light like line link lithuania littl live local
##   32      1     2    5     1    7    1    2         1     3    5     1
##     Terms
## Docs london long longer longev longterm look loophol lost lot low lurch
##   32      1    1      1      1        1    6       1    3   1   1     1
##     Terms
## Docs machineri maciej made main major make mani manufactur marcin margin
##   32         1      1    1    1     2    1    9          1      1      1
##     Terms
## Docs mark market matuszap may meant measur medic messi meteor metric might
##   32    1      5        1   1     1      2     1     1      1      1     2
##     Terms
## Docs milan million minim minist misplac misztalreporterrexshutterstock
##   32     1       1     1      2       1                              1
##     Terms
## Docs model modern modernday moment money monogorod moribund mountain move
##   32     3      1         1      1     2         1        1        1    4
##     Terms
## Docs movement much multin nagi narrow nation natur nearer need neighbour
##   32        3    5      1    1      1      1     1      1    1         1
##     Terms
## Docs neoliber network never new news next nič nondescript northwest now
##   32        2       1     3   3    1    3   1           1         1  10
##     Terms
## Docs number offic often old oligarch olivia one onefactori ongo onward
##   32      1     2     4   1        1      2  10          1    1      1
##     Terms
## Docs open oper opportun opposit optim option orbán order organis other
##   32    1    1        2       1     1      1      1     1       1     1
##     Terms
## Docs outskirt outsourc overal overwhelm pain paneuropean panoram part
##   32        2        1      1         1    1           1       1    6
##     Terms
## Docs parti particular past patronis peopl peripheri photograph piatkowski
##   32     1          1    4        1    11         1          7          4
##     Terms
## Docs picnic piec pioneer pitfal place planet plant plenti poland pole
##   32      1    1       1      1     3      1     3      2     13    2
##     Terms
## Docs polic polici polish polit poloshirt poor poorest popul popular
##   32     1      1      6     4         1    1       1     6       1
##     Terms
## Docs populist posit possibl postal postcommunist potenti practic presag
##   32        3     1       3      1             1       1       1      1
##     Terms
## Docs presid press previous prime privat prize problem process produc
##   32      1     1        1     1      1     1       2       2      1
##     Terms
## Docs product professor profit programm progress project prosper protect
##   32       1         1      1        1        4       1       1       1
##     Terms
## Docs provid public pull push put qualiti quarter question quick rang rate
##   32      2      4    1    1   1       2       2        1     1    1    1
##     Terms
## Docs rather reader real reason recent recommend redneck reflect reform
##   32      2      1    1      1      2         1       1       2      4
##     Terms
## Docs regard regim region regul relat relationship releas remain remark
##   32      1     1     23     2     2            1      1      2      1
##     Terms
## Docs rememb repeat report republ requir research respect rest restaur
##   32      1      1      1      1      2        1       1    1       1
##     Terms
## Docs return revolut riga right rippl rise road robot role romania romanian
##   32      3       1    1     1     1    2    3     1    1       2        2
##     Terms
## Docs rosi roundup rule run rural russia ryanair salari saw say scene
##   32    1       1    1   2     2      2       1      1   1  14     1
##     Terms
## Docs school scour scurri sea secondti see seed seen sell sens seri servic
##   32      1     1      1   1        1   4    3    1    2    1    3      4
##     Terms
## Docs set seven sevenfold sever shabbi shape shift shinier ship shipbuild
##   32   2     1         1     1      1     1     1       1    1         1
##     Terms
## Docs shipyard shock short shortag show shrink shrunk sign similar sinc
##   32        7     2     1       1    3      1      1    4       1    4
##     Terms
## Docs singl site situat skill sleep slovak slovakia slump small smaller
##   32     2    1      2     2     1      1        1     1     1       4
##     Terms
## Docs smart smile societi sokołowskiap solidar solut sometim sought soup
##   32     1     1       3             1       5     1       1      1    1
##     Terms
## Docs soviet sow spare speech speedili spend sport sprung spurt squat stalk
##   32      1   2     1      1        1     1     1      2     1     1     1
##     Terms
## Docs standard star startup state station statist status stay still stori
##   32        2    1       1     2       1       4      1    1     5     2
##     Terms
## Docs strengthen struggl stubborn stuck subcontractor subsidi success
##   32          1       1        1     1             1       2       3
##     Terms
## Docs suppli supplychain support sure surg surviv swim symbol symbolis
##   32      2           1       1    1    1      1    1      1        1
##     Terms
## Docs system tabl take taken tax tell term territori therapi
##   32      4    1    2     1   1    1    2         1       2
##     Terms
## Docs theupsidetheguardiancom theyr thing think thirti three time today
##   32                       2     1     4     1      1     4    4     3
##     Terms
## Docs togeth took toward tower town trade traffic trailblaz train transit
##   32      1    1      1     2    2     1       1         1     1       6
##     Terms
## Docs transport treat trip turn twice two ukrain unabl unchart underfund
##   32         1     1    1    2     1   2      2     1       1         1
##     Terms
## Docs understand unequ uneven unfair unimagin union unlik unpredict
##   32          1     1      3      1        1     1     1         1
##     Terms
## Docs unrealist unsung vast velvet version view viktor villag virtu
##   32         1      1    3      1       1    1      1      1     1
##     Terms
## Docs volkswagen wałęsa walk wall warsaw watch watchdog way wealth wealthi
##   32          1       3    1    2      1     1        1   3      2       1
##     Terms
## Docs week weld welleduc west western whether whir white whole whoosh whose
##   32    1    1        1    5       4       1    1     1     3      1     1
##     Terms
## Docs wider will wit within without wonder work worker workingag world
##   32     1    4   1      1       1      1    2      3         1     5
##     Terms
## Docs worri worth yacht year yearold yellow youd young
##   32     1     1     1   13       1      1    1     1
\end{verbatim}

\hypertarget{d.-classification.}{%
\subsection{d. Classification.}\label{d.-classification.}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(e1071)}
\KeywordTok{library}\NormalTok{(caret)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: lattice
\end{verbatim}

\begin{verbatim}
## Loading required package: ggplot2
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'ggplot2'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:NLP':
## 
##     annotate
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{TermMatrix =}\StringTok{ }\KeywordTok{removeSparseTerms}\NormalTok{(TermMatrix, }\FloatTok{0.99}\NormalTok{)}

\NormalTok{cor_matrix =}\StringTok{ }\KeywordTok{cor}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(TermMatrix))}
\NormalTok{cor_terms =}\StringTok{ }\KeywordTok{sort}\NormalTok{(}\KeywordTok{findCorrelation}\NormalTok{(cor_matrix, }\DataTypeTok{cutoff =} \FloatTok{0.9}\NormalTok{))}
\NormalTok{TermMatrix =}\StringTok{ }\NormalTok{TermMatrix[, }\OperatorTok{-}\KeywordTok{c}\NormalTok{(cor_terms)]}

\NormalTok{TM_train =}\StringTok{ }\NormalTok{TermMatrix[}\DecValTok{1}\OperatorTok{:}\KeywordTok{floor}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(TermMatrix)}\OperatorTok{*}\FloatTok{0.8}\NormalTok{),]}
\NormalTok{TM_test =}\StringTok{ }\NormalTok{TermMatrix[(}\KeywordTok{floor}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(TermMatrix)}\OperatorTok{*}\FloatTok{0.8}\NormalTok{)}\OperatorTok{+}\DecValTok{1}\NormalTok{)}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(TermMatrix),]}
\NormalTok{data_train =}\StringTok{ }\NormalTok{mydata[}\DecValTok{1}\OperatorTok{:}\KeywordTok{floor}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(mydata)}\OperatorTok{*}\FloatTok{0.8}\NormalTok{), ]}
\NormalTok{data_test =}\StringTok{ }\NormalTok{mydata[(}\KeywordTok{floor}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(mydata)}\OperatorTok{*}\FloatTok{0.8}\NormalTok{)}\OperatorTok{+}\DecValTok{1}\NormalTok{)}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(mydata), ]}
\NormalTok{data_train}\OperatorTok{$}\NormalTok{section =}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(data_train}\OperatorTok{$}\NormalTok{section)}
\NormalTok{data_test}\OperatorTok{$}\NormalTok{section =}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(data_test}\OperatorTok{$}\NormalTok{section)}

\NormalTok{m =}\StringTok{ }\KeywordTok{naiveBayes}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(TM_train), data_train}\OperatorTok{$}\NormalTok{section)}
\NormalTok{p =}\StringTok{ }\KeywordTok{predict}\NormalTok{(m, }\KeywordTok{as.matrix}\NormalTok{(TM_test))}
\KeywordTok{confusionMatrix}\NormalTok{(p, data_test}\OperatorTok{$}\NormalTok{section)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##              Reference
## Prediction    business environment science sport technology world
##   business         193          37       6     0         42    19
##   environment       11         154       9     0          7    31
##   science            2          29     184     2         17    17
##   sport              2           8      17   208         13     8
##   technology         7           3      17     3        144     5
##   world              6           7       6     4         15   156
## 
## Overall Statistics
##                                           
##                Accuracy : 0.748           
##                  95% CI : (0.7243, 0.7707)
##     No Information Rate : 0.1721          
##     P-Value [Acc > NIR] : < 2.2e-16       
##                                           
##                   Kappa : 0.6979          
##                                           
##  Mcnemar's Test P-Value : < 2.2e-16       
## 
## Statistics by Class:
## 
##                      Class: business Class: environment Class: science
## Sensitivity                   0.8733             0.6471         0.7699
## Specificity                   0.9110             0.9496         0.9417
## Pos Pred Value                0.6498             0.7264         0.7331
## Neg Pred Value                0.9744             0.9286         0.9517
## Prevalence                    0.1591             0.1713         0.1721
## Detection Rate                0.1389             0.1109         0.1325
## Detection Prevalence          0.2138             0.1526         0.1807
## Balanced Accuracy             0.8921             0.7983         0.8558
##                      Class: sport Class: technology Class: world
## Sensitivity                0.9585            0.6050       0.6610
## Specificity                0.9590            0.9696       0.9670
## Pos Pred Value             0.8125            0.8045       0.8041
## Neg Pred Value             0.9921            0.9223       0.9331
## Prevalence                 0.1562            0.1713       0.1699
## Detection Rate             0.1497            0.1037       0.1123
## Detection Prevalence       0.1843            0.1289       0.1397
## Balanced Accuracy          0.9588            0.7873       0.8140
\end{verbatim}


\end{document}
